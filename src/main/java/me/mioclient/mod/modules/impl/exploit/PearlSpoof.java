/*
 * Decompiled with CFR 0.150.
 * 
 * Could not load the following classes:
 *  net.minecraft.block.BlockEnderChest
 *  net.minecraft.block.BlockObsidian
 *  net.minecraft.item.ItemEnderPearl
 *  net.minecraft.network.Packet
 *  net.minecraft.network.play.client.CPacketHeldItemChange
 *  net.minecraft.network.play.client.CPacketPlayerTryUseItem
 *  net.minecraft.util.EnumHand
 *  net.minecraft.util.math.BlockPos
 */
package me.mioclient.mod.modules.impl.exploit;

import me.mioclient.api.managers.Managers;
import me.mioclient.api.util.world.InventoryUtil;
import me.mioclient.mod.modules.Category;
import me.mioclient.mod.modules.Module;
import net.minecraft.block.BlockEnderChest;
import net.minecraft.block.BlockObsidian;
import net.minecraft.item.ItemEnderPearl;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketHeldItemChange;
import net.minecraft.network.play.client.CPacketPlayerTryUseItem;
import net.minecraft.util.EnumHand;
import net.minecraft.util.math.BlockPos;

public class PearlSpoof
extends Module {
    public PearlSpoof() {
        super("PearlSpoof", "Pearl phase using packet spam.", Category.EXPLOIT);
    }

    @Override
    public void onEnable() {
        if (PearlSpoof.fullNullCheck()) {
            return;
        }
        int oldSlot = PearlSpoof.mc.player.inventory.currentItem;
        int obbySlot = InventoryUtil.findHotbarBlock(BlockObsidian.class);
        int echestSlot = InventoryUtil.findHotbarBlock(BlockEnderChest.class);
        int pearlSlot = InventoryUtil.findHotbarBlock(ItemEnderPearl.class);
        if (pearlSlot != -1) {
            PearlSpoof.mc.player.connection.sendPacket((Packet)new CPacketHeldItemChange(obbySlot == -1 ? echestSlot : obbySlot));
            Managers.INTERACTIONS.placeBlock(this.getRandomBlock(), false, true, false);
            PearlSpoof.mc.player.connection.sendPacket((Packet)new CPacketHeldItemChange(pearlSlot == 1 ? pearlSlot + 1 : pearlSlot - 1));
            PearlSpoof.mc.player.connection.sendPacket((Packet)new CPacketHeldItemChange(pearlSlot));
            PearlSpoof.mc.player.connection.sendPacket((Packet)new CPacketPlayerTryUseItem(EnumHand.MAIN_HAND));
            PearlSpoof.mc.player.connection.sendPacket((Packet)new CPacketHeldItemChange(oldSlot));
        }
        this.disable();
    }

    private BlockPos getRandomBlock() {
        return new BlockPos(PearlSpoof.mc.player.posX + Math.random() * 4.0, PearlSpoof.mc.player.posY + Math.random() * 3.0, PearlSpoof.mc.player.posZ + Math.random() * 4.0);
    }
}

