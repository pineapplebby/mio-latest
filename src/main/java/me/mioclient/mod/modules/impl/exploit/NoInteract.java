/*
 * Decompiled with CFR 0.150.
 * 
 * Could not load the following classes:
 *  net.minecraft.block.Block
 *  net.minecraft.init.Blocks
 *  net.minecraft.item.ItemAppleGold
 *  net.minecraft.item.ItemBow
 *  net.minecraft.item.ItemChorusFruit
 *  net.minecraft.item.ItemEnderPearl
 *  net.minecraft.item.ItemExpBottle
 *  net.minecraft.network.play.client.CPacketPlayerTryUseItemOnBlock
 *  net.minecraft.util.math.BlockPos
 *  net.minecraft.util.math.RayTraceResult
 *  net.minecraft.util.math.RayTraceResult$Type
 *  net.minecraftforge.event.entity.player.PlayerInteractEvent$RightClickBlock
 *  net.minecraftforge.fml.common.eventhandler.SubscribeEvent
 */
package me.mioclient.mod.modules.impl.exploit;

import me.mioclient.api.events.impl.PacketEvent;
import me.mioclient.api.util.interact.BlockUtil;
import me.mioclient.mod.modules.Category;
import me.mioclient.mod.modules.Module;
import net.minecraft.block.Block;
import net.minecraft.init.Blocks;
import net.minecraft.item.ItemAppleGold;
import net.minecraft.item.ItemBow;
import net.minecraft.item.ItemChorusFruit;
import net.minecraft.item.ItemEnderPearl;
import net.minecraft.item.ItemExpBottle;
import net.minecraft.network.play.client.CPacketPlayerTryUseItemOnBlock;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.RayTraceResult;
import net.minecraftforge.event.entity.player.PlayerInteractEvent;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class NoInteract
extends Module {
    public NoInteract() {
        super("NoInteract", "Allows you to eat and throw exp when looking at tile entities.", Category.EXPLOIT, true);
    }

    @SubscribeEvent
    public void onPacketSend(PacketEvent.Send event) {
        BlockPos pos;
        Block block;
        RayTraceResult ray = NoInteract.mc.objectMouseOver;
        if (ray != null && ray.typeOfHit == RayTraceResult.Type.BLOCK && event.getPacket() instanceof CPacketPlayerTryUseItemOnBlock && ((block = BlockUtil.getBlock(pos = ray.getBlockPos())) == Blocks.ANVIL || block == Blocks.ENDER_CHEST) && this.check()) {
            event.setCanceled(true);
        }
    }

    @SubscribeEvent
    public void onInteract(PlayerInteractEvent.RightClickBlock event) {
        if (NoInteract.nullCheck()) {
            return;
        }
        Block block = BlockUtil.getBlock(event.getPos());
        if ((block == Blocks.ANVIL || block == Blocks.ENDER_CHEST) && this.check()) {
            event.setCanceled(true);
        }
    }

    private boolean check() {
        return !NoInteract.mc.player.isSneaking() && NoInteract.mc.gameSettings.keyBindUseItem.isKeyDown() && (NoInteract.mc.player.getHeldItemMainhand().getItem() instanceof ItemExpBottle || NoInteract.mc.player.getHeldItemMainhand().getItem() instanceof ItemEnderPearl || NoInteract.mc.player.getHeldItemMainhand().getItem() instanceof ItemAppleGold || NoInteract.mc.player.getHeldItemMainhand().getItem() instanceof ItemBow || NoInteract.mc.player.getHeldItemMainhand().getItem() instanceof ItemChorusFruit);
    }
}

